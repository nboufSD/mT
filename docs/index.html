<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://miro.com/app/static/sdk.1.1.js"></script>
    <script>
    let allStickers;
    miro.onReady(() => {
      miro.initialize({
        extensionPoints: {
          bottomBar: {
            title: 'Some title',
            svgIcon: '<circle cx="12" cy="12" r="9" fill="none" fill-rule="evenodd" stroke="currentColor" stroke-width="2"/>',
            onClick: () => {
              miro.board.widgets.create({type: 'sticker', text: 'https://nboufsd.github.io/mT/json/sample.json'})
              // for (let i = 1; i <= 3; i++) {
              //   miro.board.widgets.create({
              //     type: "image",
              //     url: "https://nboufsd.github.io/mT/images/finger_" + String(i) + ".png",
              //     x: i * 1000,
              //     y: 0
              //   })
              // }
              // alert('IMAGE_CREATED')
              let req = new XMLHttpRequest();		  // XMLHttpRequest オブジェクトを生成する
              req.open("GET", "https://nboufsd.github.io/mT/json/sample.json"); // HTTPメソッドとアクセスするサーバーの　URL　を指定
              // req.responseType = 'json';
              req.send(null);
              req.onreadystatechange = function() {		  // XMLHttpRequest オブジェクトの状態が変化した際に呼び出されるイベントハンドラ
                if(req.readyState == 4 && req.status == 200){
                  let response = this.response;
                  if (typeof response === "string") {
                    response = JSON.parse(response);
                  } // サーバーからのレスポンスが完了し、かつ、通信が正常に終了した場合
                  console.log(response["item_code"]);		          // 取得した JSON ファイルの中身を表示
                }
              };
            }
          }
        }
      })
      miro.addListener('WIDGETS_CREATED', widget => {
        allStickers = miro.board.widgets.get({type: 'STICKER'})
        allStickers.then((value) => {
          console.log(value);
          // expected output: "Success!"
        });
        console.log(allStickers)
        alert('FINED OUT IMAGES')
      })
    })
    </script>
</head>
<body>
  <img src = "images/finger_1.png">
  <img src = "images/finger_2.png">
  <img src = "images/finger_3.png">
  HELLOW WORLD
</body>
</html>
